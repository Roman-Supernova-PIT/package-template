<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Testing your package &#8212; Roman Supernova PIT Python Packaging Guide  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=5a6b8c39" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=4c948548" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Checklist for creating a PR" href="checklist.html" />
    <link rel="prev" title="Documenting your Package" href="docs.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo_black_filled_sm.png" alt="Logo" />
    
  </a>
</p>



<p class="blurb">Roman Supernova PIT Python packaging guide and template.</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="minimal.html">Minimal package layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Documenting your Package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Testing your package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#where-to-keep-tests">Where to keep tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-tests">Running tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-default-pytest-options">Defining default pytest options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-doctests">Running doctests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#declaring-dependencies-for-tests">Declaring dependencies for tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="checklist.html">Checklist for creating a PR</a></li>
<li class="toctree-l1"><a class="reference internal" href="tox.html">Running Commands with Tox</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">Compiled C/Cython extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasing.html">Releasing Your Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Command-line scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Including data in your package</a></li>
<li class="toctree-l1"><a class="reference internal" href="ci.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced/index.html">Advanced Topics</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="docs.html" title="previous chapter">Documenting your Package</a></li>
      <li>Next: <a href="checklist.html" title="next chapter">Checklist for creating a PR</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="docs.html" title="Previous document">Documenting your Package</a>
        </li>
        <li>
          <a href="checklist.html" title="Next document">Checklist for creating a PR</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="testing-your-package">
<span id="testing"></span><h1>Testing your package<a class="headerlink" href="#testing-your-package" title="Link to this heading">¶</a></h1>
<p>While writing new functionality for your package, you should also make sure that
you write unit tests. We suggest using the <a class="reference external" href="https://docs.pytest.org/">pytest</a>
framework for writing and running tests.</p>
<section id="where-to-keep-tests">
<h2>Where to keep tests<a class="headerlink" href="#where-to-keep-tests" title="Link to this heading">¶</a></h2>
<p>We recommend placing the tests inside sub-folders called <code class="docutils literal notranslate"><span class="pre">tests</span></code> alongside the
Python code they are meant to test - for example, the layout of the
package (underneath the top level directory of the git checkout) might
look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_package</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
<span class="n">my_package</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span>
<span class="n">my_package</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
<span class="n">my_package</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">test_utils</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The name of the test files should start with <code class="docutils literal notranslate"><span class="pre">test_</span></code>. We recommend taking a look
at the <a class="reference external" href="https://docs.pytest.org/en/latest/getting-started.html">Getting Started</a>
guide for pytest for how to write tests, as well as the <a class="reference external" href="http://docs.astropy.org/en/stable/development/testguide.html#writing-tests">Astropy guide on writing
tests</a>.</p>
</section>
<section id="running-tests">
<h2>Running tests<a class="headerlink" href="#running-tests" title="Link to this heading">¶</a></h2>
<p>Assuming you have installed pytest, the easiest way to run the tests is to run the
<code class="docutils literal notranslate"><span class="pre">pytest</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="n">my_package</span>
</pre></div>
</div>
<p>Note that if your package contains C extension, you will need to make sure the
extensions are compiled ahead of time - you can either do this with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build_ext</span> <span class="o">--</span><span class="n">inplace</span>
</pre></div>
</div>
<p>or with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>Once you have done this, the pytest command should work. If your package defines
entry points, you will likely need to run the <code class="docutils literal notranslate"><span class="pre">pip</span></code> command if you are running
tests that rely on the entry points.</p>
</section>
<section id="defining-default-pytest-options">
<h2>Defining default pytest options<a class="headerlink" href="#defining-default-pytest-options" title="Link to this heading">¶</a></h2>
<p>If you regularly need to run tests with the same command-line flags for your
package, or if you want to set options that are required for certain pytest
plugins, you can control these by adding a <code class="docutils literal notranslate"><span class="pre">[tool.pytest.ini_options]</span></code> section
to your <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file; for example</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.pytest.ini_options]</span>
<span class="n">addopts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-v&quot;</span>
</pre></div>
</div>
<p>will ensure that tests are always run in verbose mode.</p>
</section>
<section id="running-doctests">
<h2>Running doctests<a class="headerlink" href="#running-doctests" title="Link to this heading">¶</a></h2>
<p>It is possible to use pytest to run doctests (blocks of code in docstrings or in
the .rst docs) as part of the test suite. If you want to do this, we recommend
using the <cite>pytest-doctestplus &lt;https://github.com/astropy/pytest-doctestplus&gt;</cite>
plugin. You can define the following options in your <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file to make
sure that this option is always enabled</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.pytest.ini_options]</span>
<span class="n">doctest_plus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;enabled&quot;</span>
<span class="n">addopts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;--doctest-rst&quot;</span>
</pre></div>
</div>
</section>
<section id="declaring-dependencies-for-tests">
<h2>Declaring dependencies for tests<a class="headerlink" href="#declaring-dependencies-for-tests" title="Link to this heading">¶</a></h2>
<p>To make it easier for contributors to get set up with the dependencies
required to run the tests, as well as to make it easier to
configure automated builds (with e.g. <a class="reference internal" href="tox.html#tox"><span class="std std-ref">tox</span></a>), you should
define an <code class="docutils literal notranslate"><span class="pre">[project.optional-dependencies]</span></code> section in
your <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file named <code class="docutils literal notranslate"><span class="pre">test</span></code> which lists the dependencies
required to run the tests (not including dependencies already
mentioned in <code class="docutils literal notranslate"><span class="pre">dependencies</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">project</span><span class="o">.</span><span class="n">optional</span><span class="o">-</span><span class="n">dependencies</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;pytest&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pytest-doctestplus&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This will then allow contributors to type</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;.[test]&quot;</span>
</pre></div>
</div>
<p>to install the package in developer/editable mode along with the test
dependencies.</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="docs.html" title="Previous document">Documenting your Package</a>
        </li>
        <li>
          <a href="checklist.html" title="Next document">Checklist for creating a PR</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2024, Roman Supernova PIT.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.0.4</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/tests.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>